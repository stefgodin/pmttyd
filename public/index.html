<!DOCTYPE html>
<html lang="en">

<head>
    <title>PMTTYD</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <!-- xs -->
    <style>
        *:not(:defined) {
            display: none;
        }

        @font-face {
            font-family: 'HeyGorgeous';
            src: url('/static/heygorgeous.ttf');
        }

        :root {
            --color-light: white;
            --color-base: grey;
            --color-dark: black;

            font-family: Verdana, sans-serif;
        }

        .badges {
            --color-light: #c5fd81;
            --color-base: #41de30;
            --color-dark: #259a19;
        }

        .recipes {
            --color-light: #e39bbf;
            --color-base: #da7aaa;
            --color-dark: #b43273;
        }

        .free-red {
            --color-light: #e7a698;
            --color-base: #da7762;
            --color-dark: #d05840;
        }

        .starpieces {
            --color-light: #ebd193;
            --color-base: #e6c576;
            --color-dark: #c29323;
        }

        .shinesprites {
            --color-light: #9abce5;
            --color-base: #558ed3;
            --color-dark: #2f6cb6;
        }

        .tattlelog {
            --color-light: #bfb2cd;
            --color-base: #876fa1;
            --color-dark: #59476c;
        }

        html {
            margin: 0;
            padding: 0;
            min-height: 100%;
        }

        body {
            background-image: url('/static/background_1.png');
            background-size: cover;
            background-repeat: no-repeat;
            min-height: 100%;
            margin: 0;
            padding: 0;
        }

        main {
            margin-top: 3em;
            padding: 0.25em;
            max-width: 996px;
            margin-left: auto;
            margin-right: auto;
        }

        .list-container {
            background-size: 200px;
            background-color: var(--color-base);
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23);
        }

        .list {
            list-style-type: none;
            margin: 0;
            background-color: transparent;
            background-image: url('/static/items_background.png');
            background-size: 200px;
            padding: 1em;
            border-radius: 10px;
            background-color: var(--color-light);
        }

        .list li {
            display: inline-block;
            filter: drop-shadow(0px 0px 3px);
        }

        .list li:hover {
            transform: scale(1.1);
            filter: drop-shadow(0px 0px 3px) brightness(1.2);
        }

        .item-dialog {
            border: none;
            background-color: transparent;
        }

        .item-dialog.badges {
            max-width: 600px;
        }

        .item-dialog::backdrop {
            background-color: black;
            opacity: 0.2;
        }

        .item-dialog-body {
            padding: 20px 0;
            background-size: 200px;
            background-color: var(--color-base);
            border-radius: 10px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23);
        }

        .item-dialog-content {
            background-image: url('/static/items_background.png');
            background-size: 200px;
            padding: 1em;
            background-color: var(--color-light);
        }

        .item-sprite {
            display: inline-block;
        }

        .item-title {
            font-family: HeyGorgeous;
            font-size: 1.25em;
            font-weight: bold;
            text-transform: uppercase;
        }

        .item-description {
            font-family: HeyGorgeous;
            white-space: pre-line;
        }

        .dialog-close-button {
            position: sticky;
            bottom: 0;
        }

        .badge-points {
            font-family: HeyGorgeous;
            margin-bottom: 1.5em;
        }

        .text-bubble {
            font-size: 0.75em;
            text-align: left;
            position: relative;
            background-color: white;
            border-radius: 20px;
            box-shadow: inset 0px -5px 5px 0px rgba(0, 0, 0, 0.5);
            padding: 2em 1em;
            margin-top: -10px;
            margin-left: 0.15em;
            margin-right: 0.15em;
            margin-bottom: 20px;
        }

        .text-bubble-close-button {
            cursor: pointer;
            position: absolute;
            bottom: -20px;
            right: -20px;
            background-image: url('/static/small_star.png');
            background-color: transparent;
            border: 0;
            height: 60px;
            width: 60px;
            padding: 0;
        }

        .recipe-list-container {
            display: flex;
            flex-wrap: wrap;
            gap: 0.25em;
        }
    </style>

    <!-- sm -->
    <style media="(min-width: 576px)">
        main {
            padding: 1em;
        }

        .nav-section:first-child {
            margin-left: 1em;
        }

        .text-bubble {
            margin-left: 1em;
            margin-right: 1em;
        }
    </style>

    <!-- md -->
    <style media="(min-width: 768px)">
    </style>

    <!-- lg -->
    <style media="(min-width: 992px)">
    </style>

    <!-- xl -->
    <style media="(min-width: 1200px)">
    </style>
</head>

<body>
    <app-nav></app-nav>
    <main id="router-view"></main>

    <script src="/shared.js"></script>
    <script>
        $app.loadComponents('app-nav');
        (() => {
            const SECTIONS = {
                BADGES: "badges",
                RECIPES: "recipes",
                STARPIECES: "starpieces",
                SHINESPRITES: "shinesprites",
                TATTLELOG: "tattlelog",
            };

            let activeRoute = null;
            const routerViewEl = document.getElementById('router-view');
            const ROUTES = [
                {
                    resolve: (segments) => segments[0] === 'badges',
                    setup: async () => {
                        await $app.loadComponent('app-badges');
                        const badgesEl = document.createElement('app-badges');
                        routerViewEl.replaceChildren(badgesEl);
                    },
                    change: (segments) => {
                        routerViewEl.querySelector('app-badges').setAttribute('badge', segments[1] ?? '');
                    }
                },
                {
                    resolve: (segments) => segments[0] === 'recipes',
                    setup: async () => {
                        await $app.loadComponent('app-recipes');
                        const recipesEl = document.createElement('app-recipes');
                        routerViewEl.replaceChildren(recipesEl);
                    },
                    change: (segments) => {
                        routerViewEl.querySelector('app-recipes').setAttribute('item', segments[1] ?? '');
                    }
                },
                {
                    resolve: (segments) => segments[0] === 'starpieces',
                    setup: async () => {
                        await $app.loadComponent('app-starpieces');
                        const starpiecesEl = document.createElement('app-starpieces');
                        routerViewEl.replaceChildren(starpiecesEl);
                    }
                },
                {
                    resolve: (segments) => segments[0] === 'shinesprites',
                    setup: async () => {
                        await $app.loadComponent('app-shinesprites');
                        const shinespritesEl = document.createElement('app-shinesprites');
                        routerViewEl.replaceChildren(shinespritesEl);
                    }
                },
                {
                    resolve: (segments) => segments[0] === 'tattlelog',
                    setup: async () => {
                        await $app.loadComponent('app-tattlelog');
                        const tattlelogEl = document.createElement('app-tattlelog');
                        routerViewEl.replaceChildren(tattlelogEl);
                    }
                },
                {
                    // Catch all route
                    resolve: () => true,
                    change: () => window.location.hash = '#!/badges'
                },
            ];

            const handleRoute = async () => {
                const segments = (window.location.hash ?? '').replace('#!', '').split('/').filter(Boolean);
                const nextRoute = ROUTES.find((r) => r.resolve(segments)) ?? null;
                if (nextRoute === null) {
                    return;
                }

                if (activeRoute !== nextRoute) {
                    activeRoute = nextRoute;
                    if (typeof activeRoute.setup === "function") {
                        await Promise.resolve(activeRoute.setup(segments));
                    }
                }

                if (typeof activeRoute.change === "function") {
                    await Promise.resolve(activeRoute.change(segments));
                }
            };

            window.addEventListener('hashchange', handleRoute);
            handleRoute();
        })();
    </script>
</body>

</html>
